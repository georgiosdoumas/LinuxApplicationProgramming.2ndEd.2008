/* Extended and corrected version of listing11.1 on page 152 */ 
#include <stdio.h>
#include <errno.h>
#include <string.h>
#include <stdlib.h> /* for exit()  */
#define MYFILE "nonexistentfile.txt"
int main(int argc, char* argv[])
{
  FILE *infp;
  if(argc == 2)   /* a filename was passed as a cmdline argument, open it for reading */
    infp = fopen( argv[1], "r");
  else
    infp = fopen( MYFILE, "r" ); /* Try to open the MYFILE file for reading */
  if (infp == (FILE *)NULL)  /* Check for failure to open */
  {
    /* Emit an error message and exit */
    printf("%s: %s\n", MYFILE, strerror( errno ) );
    exit(-1);
  }
  printf( "Opened '%s' succesfully for reading, now we close it \n", argv[1]);
  fclose( infp );   /* All was well, close the file */
}
/*  gcc -Wall page152_listing11.1_fopentest.c -o page152_listing11.1_fopentest
./page152_listing11.1_fopentest
*/
